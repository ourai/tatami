/*! hanger 2014-03-14 */
(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N;j={name:"Hanger",version:"<%= pkg.version %>"},g=1,a=2,n=3,b=4,i=5,h=6,l=7,c=8,e=9,f=10,d=11,k=12,m=/^[0-9A-Z_.]+[^_.]?$/i,N={},K={storage:!!window.localStorage},A={key:{storage:["sandboxStarted","config","fn","buffer","pool","i18n","web_api"]}},s=function(){var a,b;return b=y(document.scripts),a=document.createElement("a"),a.href=b.hasAttribute?b.src:b.getAttribute("src",4),a.pathname.replace(/[^\/]+\.js$/i,"")},I=function(a,b){return[].slice.call(a,Number(b)||0)},y=function(a){return I(a,-1)[0]},H=function(){return $.ajaxSetup({type:"post",dataType:"json"}),$(document).ajaxError(function(a,b){var c;return c=b.responseText,!1})},L=function(a,b,c,d){var e,f,g,h;return h=!1,"string"===$.type(a)&&(a=a.toLowerCase(),$.isFunction($.fn.dialog)?(g="systemDialog",f=J.i18n._SYS.dialog[N.config("lang")],J.pool.hasOwnProperty(g)||(J.pool[g]={}),e=J.pool[g][a],e||(e=$('<div data-role="dialog" data-type="system" />').appendTo($("body")).on({dialogcreate:v("systemDialog"),dialogopen:function(){return $(".ui-dialog-buttonset .ui-button",$(this).closest(".ui-dialog")).each(function(){var b;switch(b=$(this),$.trim(b.text())){case f.ok:a="ok";break;case f.cancel:a="cancel";break;case f.yes:a="yes";break;case f.no:a="no"}return b.addClass("ui-button-"+a)})}}).dialog({title:f.title,width:400,minHeight:100,closeText:f.close,modal:!0,autoOpen:!1,resizable:!1,closeOnEscape:!1}),J.pool[g][a]=e,e.closest(".ui-dialog").find(".ui-dialog-titlebar-close").remove()),h=M(a,b,c,d)):(h=!0,"alert"===a?window.alert(b):window.confirm(b)?$.isFunction(c)&&c():$.isFunction(d)&&d())),h},M=function(a,b,c,d){var e,f,g,h,i,j;return j=J.i18n._SYS.dialog[N.config("lang")],i=function(a,b){return $(this).dialog("close"),$.isFunction(a)&&a(),b},f=[],e={ok:j.ok,cancel:j.cancel,yes:j.yes,no:j.no},g=J.pool.systemDialog[a],h=$("[data-role='dialog-content']",g),0===h.size()&&(h=g),"confirm"===a?(f.push({text:e.ok,click:function(){return i.apply(this,[c,!0]),!0}}),f.push({text:e.cancel,click:function(){return i.apply(this,[d,!1]),!0}})):"confirmex"===a?(f.push({text:e.yes,click:function(){return i.apply(this,[c,!0]),!0}}),f.push({text:e.no,click:function(){return i.apply(this,[d,!1]),!0}}),f.push({text:e.cancel,click:function(){return i.apply(this,[null,!1]),!0}})):(a="alert",null!==c?f.push({text:e.ok,click:function(){return i.apply(this,[c,!0]),!0}}):f=null),h.html(b||""),g.dialog("option","buttons",f).dialog("open")},o=function(){var a,b,c,d,e,f;if(a=arguments,f=a[0],e=a[1],b=J.fn.handler,0===a.length)e=p(b);else if("string"==typeof f)$.isFunction(e)?b[f]=e:e=b[f];else if($.isPlainObject(f))for(d in f)c=f[d],$.isFunction(c)&&(b[d]=c);return e},E=function(a){var b,c,d,e,f;if(b=I(arguments,1),c=J.fn.handler[a],d=null,"string"==typeof a&&$.isFunction(c))d=c.apply(window,b);else if($.isArray(a))for(e=0,f=a.length;f>e;e++)c=a[e],$.isFunction(c)&&c.call(window);return d},B=function(a,b){return $.isFunction(a)?J.fn[b].push(a):void 0},D=function(a){return p($.isPlainObject(a)?$.extend(J.config,a):J.config)},p=function(a){var b;return b=null,$.isArray(a)||void 0!==a.length?b=[].concat([],I(a)):$.isPlainObject(a)&&(b=$.extend(!0,{},a)),b},u=function(){var a,b,c;return a=arguments,c=a[0],b=a[1],$.isPlainObject(c)?$.each(c,u):"string"===$.type(c)&&J.fn.init.hasOwnProperty(c)&&$.isFunction(b)?J.fn.init[c]=b:void 0},v=function(a){return J.fn.init[a]},C=function(a,b,c,d){var e;if(0!==arguments.length)return $.isPlainObject(a)===!1&&(a={url:a}),e=v("ajaxHandler")(b,c),$.isFunction(a.success)||(a.success=e.success),$.isFunction(a.error)||(a.error=e.error),$.ajax($.extend(a,{async:d!==!0}))},r=function(a){var b,c;return b={},c=a.match(/<[a-z]+[^>]*>/i),null!==c&&$.each(c[0].match(/(data(-[a-z]+)+=[^\s>]*)/gi)||[],function(a,c){return c=c.match(/data-(.*)="([^\s"]*)"/i),b[$.camelCase(c[1])]=c[2],!0}),b},q=function(b){var c;return c={},$.each(b,function(b,d){var e;return d.nodeType===a&&(e=d.nodeName.match(/^data-(.*)$/i))&&(c[$.camelCase(e(1))]=d.nodeValue),!0}),c},t=function(a,b){var c,d;return c=a.split("."),d=null,(b||!x(c[0],A.key.storage))&&(d=J,$.each(c,function(a,b){var c;return c=d.hasOwnProperty(b),d=d[b],c})),d},G=function(a,b){var c,d,e,f,g;return f=a.split("."),e=f.length,c=$.isPlainObject(b),1===e?(d=f[0],g=F(J,d,b,J.hasOwnProperty(d))):(g=J,$.each(f,function(a,c){return e-1>a?g.hasOwnProperty(c)||(g[c]={}):g[c]=F(g,c,b,$.isPlainObject(g[c])),g=g[c],!0})),g},F=function(a,b,c,d){return d&&$.isPlainObject(c)?$.extend(!0,a[b],c):a[b]=c,a[b]},w=function(a,b,c){return"object"===$.type(a)&&"string"===$.type(b)&&a.hasOwnProperty(b)&&$.type(a[b])===c},x=function(a,b){return $.inArray(a,b)>-1},z=function(a){return A.key.storage.push(a)},J={sandboxStarted:!1,config:{debug:!0,platform:"",api:"",lang:(document.documentElement.lang||document.documentElement.getAttribute("lang")||navigator.language||navigator.browserLanguage).split("-")[0],path:s()},fn:{prepare:[],ready:[],init:{systemDialog:$.noop,ajaxHandler:function(a,b){return{success:function(c){var d;return d=I(arguments),c.code>0?$.isFunction(a)?a.apply($,d):void 0:$.isFunction(b)?b.apply($,d):L("alert",c.message)},error:$.noop}}},handler:{}},buffer:{},pool:{},i18n:{_SYS:{dialog:{zh:{title:"系统提示",close:"关闭",ok:"确定",cancel:"取消",yes:"是",no:"否"},en:{title:"System",close:"Close",ok:"Ok",cancel:"Cancel",yes:"Yes",no:"No"}}}},web_api:{}},$.extend(N,{mask:function(a){var b;return b=!1,"string"!==$.type(a)||window.hasOwnProperty(a)||(window[a]=window[j.name],b=delete window[j.name],j.name=a),b},alert:function(a,b){return L("alert",a,b)},confirm:function(a,b,c){return L("confirm",a,b,c)},confirmEX:function(a,b,c){return L("confirmEX",a,b,c)},sandbox:function(a){var b;return J.sandboxStarted!==!0&&(b=D(a),E(J.fn.prepare),$(document).ready(function(){return E(J.fn.ready)}),J.sandboxStarted=!0),b||!1},prepare:function(a){return B(a,"prepare")},ready:function(a){return B(a,"ready")},init:function(){return u.apply(window,I(arguments))},config:function(a){return"string"===$.type(a)?J.config[a]:p(J.config)},ajax:function(a,b,c){return C(a,b,c)},sjax:function(a,b,c){return C(a,b,c,!0)},queue:function(){return o.apply(window,I(arguments))},run:function(){return E.apply(window,I(arguments))},data:function(){var a,b,c,d,e,f;if(a=arguments,c=a.length,c>0){f=a[0];try{d=$(f).get(0)}catch(h){b=h,d=f}d&&d.nodeType===g?(e={},d.dataset?e=d.dataset:d.outerHTML?e=r(d.outerHTML):d.attributes&&$.isNumeric(d.attributes.length)&&(e=q(d.attributes))):"string"==typeof f&&m.test(f)&&(e=1===c?t(f):G(f,a[1]),c>1&&y(a)===!0&&z(f.split(".")[0]))}return e||null},i18n:function(){var a,b,c,d;return a=arguments,c=a[0],d=null,$.isPlainObject(c)?$.extend(J.i18n,c):m.test(c)&&(b=a[1],(2!==a.length||"string"!=typeof b||m.test(b))&&($.isPlainObject(b)?(d=t("i18n."+c,!0),d=("string"==typeof d?d:"").replace(/\{%\s*([A-Z0-9_]+)\s*%\}/gi,function(a,c){return b[c]})):(d="",$.each(a,function(a,b){var c;return"string"==typeof b&&m.test(b)?(c=t("i18n."+b,!0),d+="string"==typeof c?c:""):void 0})))),d},api:function(){var a,b,c,d,e,f,g,h,i;return b=arguments,d=b[0],g=null,$.isPlainObject(d)?$.extend(J.web_api,d):"string"===$.type(d)&&(f=/^([a-z]+)_/,e=(null!=(i=d.match(f))?i:[])[1],c=b[1],h=void 0,$.each(["front","admin"],function(a,b){return e===b?(h=b,!1):void 0}),h?d=d.replace(f,""):h="common",a=this.config("api"),a="string"===$.type(a)&&""!==$.trim(a)?"/"+a:"",g=a+t("web_api."+h+"."+d,!0),$.isPlainObject(c)&&(g=g.replace(/\:([a-z_]+)/g,function(a,b){return c[b]}))),g},save:function(){var a,b,c,d;return a=arguments,b=a[0],d=a[1],K.storage&&"string"==typeof b?(c=this.access(b),localStorage.setItem(b,escape($.isPlainObject(c)?JSON.stringify($.extend(c,d)):d))):void 0},access:function(){var a,b,c;if(b=arguments[0],"string"==typeof b&&K.storage&&(c=localStorage.getItem(b),null!==c)){c=unescape(c);try{c=JSON.parse(c)}catch(d){a=d,c=c}}return c||null},url:function(){var a,b;return a=window.location,b={search:a.search.substring(1),hash:a.hash.substring(1),query:{}},$.each(b.search.split("&"),function(a,c){return c=c.split("="),""!==$.trim(c[0])?b.query[c[0]]=c[1]:void 0}),b},download:function(a,b){var c,d,e;return window.ActiveXObject?window.ActiveXObject&&document.execCommand?(e=window.open(a,"_blank"),e.document.close(),e.document.execCommand("SaveAs",!0,b||a),e.close()):void 0:(d=document.createElement("a"),d.href=a,d.target="_blank",d.download=b||"unknown",c=document.createEvent("Event"),c.initEvent("click",!0,!0),d.dispatchEvent(c),(window.URL||window.webkitURL).revokeObjectURL(d.href))},functionExists:function(a,b){return w(b===!0?window:J.fn.handler,a,"function")},pad:function(a,b,c){var d,e,f;if($.type(a)in{string:!0,number:!0}&&(("string"!==$.type(c)||1!==c.length)&&(c=" "),$.isNumeric(b)&&/^-?[1-9]\d*$/.test(b)||(b=0),a=String(a),d=1,f=String(c),e=Math.abs(b)-a.length,e>0)){for(;e>d;)c+=f,d++;a=b>0?a+c:c+a}return a},zerofill:function(a,b){var c,d,e,f;return e="",$.isNumeric(a)&&$.isNumeric(b)&&/^-?[1-9]\d*$/.test(b)&&(f=/^([-+]?\d+)\.(\d+)$/,c=f.test(a),d="",b=parseInt(b),b>0&&c?(a=(""+a).match(f),d=""+1*a[1]+".",a=a[2]):0>1*a&&(d="-",a=(""+a).substring(1)),e=this.pad(a,b,"0"),e=0>b&&c?"":d+e),e}}),window[j.name]=N}).call(this);