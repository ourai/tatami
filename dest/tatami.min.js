/*! tatami 2014-04-02 */
!function(a,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("Requires a window with a document");return b(a)}:b(a)}("undefined"!=typeof window?window:this,function(a){"use strict";var b,c,d,e,f;b={name:"Matcha",version:"0.1.1"},f={hook:{tabs:{component:"tabs",trigger:"tabs-trigger",content:"tabs-content"}}},d=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},e=function(a,b){return(b===!0?"":".")+"js-"+$.camelCase(c("hook."+a))},c=function(a){var b,c;return b=a.split("."),c=f,$.each(b,function(a,b){var e;return e=d(c,b),c=c[b],e}),c},a[b.name]=_H}),function(a,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("Requires a window with a document");return b(a)}:b(a)}("undefined"!=typeof window?window:this,function(a){"use strict";var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R;l={name:"Tatami",version:"0.1.1"},i=1,c=2,p=3,d=4,k=5,j=6,n=7,e=8,g=9,h=10,f=11,m=12,o=/^[0-9A-Z_.]+[^_.]?$/i,R={},Q={lang:document.documentElement.lang||document.documentElement.getAttribute("lang")||navigator.language||navigator.browserLanguage},b=jQuery,N={storage:!!a.localStorage},D={key:{storage:["sandboxStarted","config","fn","buffer","pool","i18n","web_api"]}},M={sandboxStarted:!1,config:{debug:!0,platform:"",api:"",locale:Q.lang,lang:Q.lang.split("-")[0]},fn:{prepare:[],ready:[],init:{systemDialog:b.noop,ajaxHandler:function(a,c){return{success:function(d){var e;return e=L(arguments),d.code>0?b.isFunction(a)?a.apply(b,e):void 0:b.isFunction(c)?c.apply(b,e):O("alert",d.message)},error:b.noop}}},handler:{}},buffer:{},pool:{},i18n:{_SYS:{dialog:{zh:{title:"系统提示",close:"关闭",ok:"确定",cancel:"取消",yes:"是",no:"否"},en:{title:"System",close:"Close",ok:"Ok",cancel:"Cancel",yes:"Yes",no:"No"}}}},web_api:{}},w=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},L=function(a,b){return[].slice.call(a,Number(b)||0)},B=function(a){return L(a,-1)[0]},K=function(){return b.ajaxSetup({type:"post",dataType:"json"}),b(document).ajaxError(function(a,b){var c;return c=b.responseText,!1})},O=function(c,d,e,f){var g,h,i,j;return j=!1,"string"===b.type(c)&&(c=c.toLowerCase(),b.isFunction(b.fn.dialog)?(i="systemDialog",h=M.i18n._SYS.dialog[R.config("lang")],w(M.pool,i)||(M.pool[i]={}),g=M.pool[i][c],g||(g=b('<div data-role="dialog" data-type="system" />').appendTo(b("body")).on({dialogcreate:y("systemDialog"),dialogopen:function(){return b(".ui-dialog-buttonset .ui-button",b(this).closest(".ui-dialog")).each(function(){var a;switch(a=b(this),b.trim(a.text())){case h.ok:c="ok";break;case h.cancel:c="cancel";break;case h.yes:c="yes";break;case h.no:c="no"}return a.addClass("ui-button-"+c)})}}).dialog({title:h.title,width:400,minHeight:100,closeText:h.close,modal:!0,autoOpen:!1,resizable:!1,closeOnEscape:!1}),M.pool[i][c]=g,g.closest(".ui-dialog").find(".ui-dialog-titlebar-close").remove()),j=P(c,d,e,f)):(j=!0,"alert"===c?a.alert(d):a.confirm(d)?b.isFunction(e)&&e():b.isFunction(f)&&f())),j},P=function(a,c,d,e){var f,g,h,i,j,k;return k=M.i18n._SYS.dialog[R.config("lang")],j=function(a,c){return b(this).dialog("close"),b.isFunction(a)&&a(),c},g=[],f={ok:k.ok,cancel:k.cancel,yes:k.yes,no:k.no},h=M.pool.systemDialog[a],i=b("[data-role='dialog-content']",h),0===i.size()&&(i=h),"confirm"===a?(g.push({text:f.ok,click:function(){return j.apply(this,[d,!0]),!0}}),g.push({text:f.cancel,click:function(){return j.apply(this,[e,!1]),!0}})):"confirmex"===a?(g.push({text:f.yes,click:function(){return j.apply(this,[d,!0]),!0}}),g.push({text:f.no,click:function(){return j.apply(this,[e,!1]),!0}}),g.push({text:f.cancel,click:function(){return j.apply(this,[null,!1]),!0}})):(a="alert",null!==d?g.push({text:f.ok,click:function(){return j.apply(this,[d,!0]),!0}}):g=null),i.html(c||""),h.dialog("option","buttons",g).dialog("open")},r=function(){var a,c,d,e,f,g;if(a=arguments,g=a[0],f=a[1],c=M.fn.handler,0===a.length)f=s(c);else if("string"==typeof g)b.isFunction(f)?c[g]=f:f=c[g];else if(b.isPlainObject(g))for(e in g)d=g[e],b.isFunction(d)&&(c[e]=d);return f},H=function(c){var d,e,f,g;if(e=null,b.isArray(c))for(f=0,g=c.length;g>f;f++)d=c[f],(b.isFunction(d)||b.isFunction(d=M.fn.handler[d]))&&d.call(a);else"string"==typeof c&&(d=M.fn.handler[c],b.isFunction(d)&&(e=d.apply(a,L(arguments,1))));return e},E=function(a,c){return b.isFunction(a)?M.fn[c].push(a):void 0},s=function(a){var c;return c=null,b.isArray(a)||void 0!==a.length?c=[].concat([],L(a)):b.isPlainObject(a)&&(c=b.extend(!0,{},a)),c},y=function(a){return M.fn.init[a]},v=function(a,c){var d,e;return d=a.split("."),e=null,(c||!A(d[0],D.key.storage))&&(e=M,b.each(d,function(a,b){var c;return c=w(e,b),e=e[b],c})),e},J=function(a,c){var d,e,f,g,h;return g=a.split("."),f=g.length,d=b.isPlainObject(c),1===f?(e=g[0],h=I(M,e,c,w(M,e))):(h=M,b.each(g,function(a,d){return f-1>a?w(h,d)||(h[d]={}):h[d]=I(h,d,c,b.isPlainObject(h[d])),h=h[d],!0})),h},I=function(a,c,d,e){return e&&b.isPlainObject(d)?b.extend(!0,a[c],d):a[c]=d,a[c]},z=function(a,c,d){return"object"===b.type(a)&&"string"===b.type(c)&&w(a,c)&&b.type(a[c])===d},A=function(a,c){return b.inArray(a,c)>-1},C=function(a){return D.key.storage.push(a)},b.extend(R,{alert:function(a,b){return O("alert",a,b)},confirm:function(a,b,c){return O("confirm",a,b,c)},confirmEX:function(a,b,c){return O("confirmEX",a,b,c)},queue:function(){return r.apply(a,L(arguments))},run:function(){return H.apply(a,L(arguments))},url:function(){var c,d;return c=a.location,d={search:c.search.substring(1),hash:c.hash.substring(1),query:{}},b.each(d.search.split("&"),function(a,c){return c=c.split("="),""!==b.trim(c[0])?d.query[c[0]]=c[1]:void 0}),d},download:function(b,c){var d,e,f;return a.ActiveXObject?a.ActiveXObject&&document.execCommand?(f=a.open(b,"_blank"),f.document.close(),f.document.execCommand("SaveAs",!0,c||b),f.close()):void 0:(e=document.createElement("a"),e.href=b,e.target="_blank",e.download=c||"unknown",d=document.createEvent("Event"),d.initEvent("click",!0,!0),e.dispatchEvent(d),(a.URL||a.webkitURL).revokeObjectURL(e.href))},functionExists:function(b,c){return z(c===!0?a:M.fn.handler,b,"function")},pad:function(a,c,d){var e,f,g;if(b.type(a)in{string:!0,number:!0}&&(("string"!==b.type(d)||1!==d.length)&&(d=" "),b.isNumeric(c)&&/^-?[1-9]\d*$/.test(c)||(c=0),a=String(a),e=1,g=String(d),f=Math.abs(c)-a.length,f>0)){for(;f>e;)d+=g,e++;a=c>0?a+d:d+a}return a},zerofill:function(a,c){var d,e,f,g;return f="",b.isNumeric(a)&&b.isNumeric(c)&&/^-?[1-9]\d*$/.test(c)&&(g=/^([-+]?\d+)\.(\d+)$/,d=g.test(a),e="",c=parseInt(c),c>0&&d?(a=(""+a).match(g),e=""+1*a[1]+".",a=a[2]):0>1*a&&(e="-",a=(""+a).substring(1)),f=this.pad(a,c,"0"),f=0>c&&d?"":e+f),f},hasOwnProp:function(){return w.apply(a,L(arguments))}}),G=function(a){return s(b.isPlainObject(a)?b.extend(M.config,a):M.config)},b.extend(R,{sandbox:function(a){var c;return M.sandboxStarted!==!0&&(c=G(a),H(M.fn.prepare),b(document).ready(function(){return H(M.fn.ready)}),M.sandboxStarted=!0),c||!1},prepare:function(a){return E(a,"prepare")},ready:function(a){return E(a,"ready")}}),x=function(){var a,c,d;return a=arguments,d=a[0],c=a[1],b.isPlainObject(d)?b.each(d,x):"string"===b.type(d)&&w(M.fn.init,d)&&b.isFunction(c)?M.fn.init[d]=c:void 0},q=function(){var a;return a=R.config("api"),"string"===b.type(a)&&""!==b.trim(a)?"/"+a:""},b.extend(R,{mask:function(c){var d,e;if(e=!1,"string"===b.type(c))if(w(a,c))a.console&&console.error("'"+c+"' has existed as a property of Window object.");else{a[c]=a[l.name];try{e=delete a[l.name]}catch(f){d=f,a[l.name]=void 0,e=!0}l.name=c}return e},config:function(a){return"string"===b.type(a)?M.config[a]:s(M.config)},init:function(){return x.apply(a,L(arguments))},i18n:function(){var a,c,d,e;return a=arguments,d=a[0],e=null,b.isPlainObject(d)?b.extend(M.i18n,d):o.test(d)&&(c=a[1],(2!==a.length||"string"!=typeof c||o.test(c))&&(b.isPlainObject(c)?(e=v("i18n."+d,!0),e=("string"==typeof e?e:"").replace(/\{%\s*([A-Z0-9_]+)\s*%\}/gi,function(a,b){return c[b]})):(e="",b.each(a,function(a,b){var c;return"string"==typeof b&&o.test(b)?(c=v("i18n."+b,!0),e+="string"==typeof c?c:""):void 0})))),e},api:function(){var a,c,d,e,f,g,h,i;return a=arguments,d=a[0],g=null,b.isPlainObject(d)?b.extend(M.web_api,d):"string"===b.type(d)&&(f=/^([a-z]+)_/,e=(null!=(i=d.match(f))?i:[])[1],c=a[1],h=void 0,b.each(["front","admin"],function(a,b){return e===b?(h=b,!1):void 0}),h?d=d.replace(f,""):h="common",g=q()+v("web_api."+h+"."+d,!0),b.isPlainObject(c)&&(g=g.replace(/\:([a-z_]+)/g,function(a,b){return c[b]}))),g}}),u=function(a){var c,d;return c={},d=a.match(/<[a-z]+[^>]*>/i),null!==d&&b.each(d[0].match(/(data(-[a-z]+)+=[^\s>]*)/gi)||[],function(a,d){return d=d.match(/data-(.*)="([^\s"]*)"/i),c[b.camelCase(d[1])]=d[2],!0}),c},t=function(a){var d;return d={},b.each(a,function(a,e){var f;return e.nodeType===c&&(f=e.nodeName.match(/^data-(.*)$/i))&&(d[b.camelCase(f(1))]=e.nodeValue),!0}),d},b.extend(R,{data:function(){var a,c,d,e,f,g;if(a=arguments,d=a.length,d>0){g=a[0];try{e=b(g).get(0)}catch(h){c=h,e=g}e&&e.nodeType===i?(f={},e.dataset?f=e.dataset:e.outerHTML?f=u(e.outerHTML):e.attributes&&b.isNumeric(e.attributes.length)&&(f=t(e.attributes))):"string"==typeof g&&o.test(g)&&(f=1===d?v(g):J(g,a[1]),d>1&&B(a)===!0&&C(g.split(".")[0]))}return null!=f?f:null},save:function(){var a,c,d,e;return a=arguments,c=a[0],e=a[1],N.storage&&"string"==typeof c?(d=this.access(c),localStorage.setItem(c,escape(b.isPlainObject(d)?JSON.stringify(b.extend(d,e)):e))):void 0},access:function(){var a,b,c;if(b=arguments[0],"string"==typeof b&&N.storage&&(c=localStorage.getItem(b),null!==c)){c=unescape(c);try{c=JSON.parse(c)}catch(d){a=d,c=c}}return c||null}}),F=function(a,c,d,e){var f;if(0!==arguments.length)return b.isPlainObject(a)===!1&&(a={url:a}),f=y("ajaxHandler")(c,d),b.isFunction(a.success)||(a.success=f.success),b.isFunction(a.error)||(a.error=f.error),b.ajax(b.extend(a,{async:e!==!0}))},b.extend(R,{ajax:function(a,b,c){return F(a,b,c)},sjax:function(a,b,c){return F(a,b,c,!0)}}),b.extend(R,{encodeEntities:function(a){return"string"===b.type(a)?a.replace(/([<>&\'\"])/,function(a,b){var c;switch(b){case"<":c=lt;break;case">":c=gt;break;case'"':c=quot;break;case"'":c=apos;break;case"&":c=amp}return"&"+c+";"}):a},decodeEntities:function(){}}),a[l.name]=R});