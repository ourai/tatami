/*!
 * Tatami v0.2.3
 * http://ourai.github.io/tatami/
 *
 * Copyright 2013, 2015 Ourairyu, http://ourai.ws/
 *
 * Date: 2015-07-18
 */
!function(a,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("Requires a window with a document");return b(a)}:b(a)}("undefined"!=typeof window?window:this,function(a,b){"use strict";var c,d,e,f,g=[].slice;f=function(){var b,c,d,e,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E;e={name:"Ronin",version:"0.3.1"},E=function(a){var b,c,d,f,g,h,i,j;return j={}.toString,h={validator:function(){return!0}},i={types:{}},g=function(){var a,b,c,d,e;for(b="Boolean Number String Function Array Date RegExp Object".split(" "),c=function(a){var b,c;return i.types["[object "+a+"]"]=c=a.toLowerCase(),b="Number"===a?function(a){return isNaN(a)?!1:this.type(a)===c}:function(a){return this.type(a)===c},i.methods["is"+a]=b},d=0,e=b.length;e>d;d++)a=b[d],c(a);return i.types},f=function(a,b){return null==a?!1:Object.prototype.hasOwnProperty.call(a,b)},d=function(a){var b,c,d;c="__"+e.name.toLowerCase()+"__",d=!0;try{Object.defineProperty(a,c,{__proto__:null,value:d})}catch(f){b=f,a[c]=d}return!0},c=function(a,d,e){var f;return f=i.methods,f.isArray(d)||f.isPlainObject(d)&&!f.isArray(d.handlers)?f.each(d,function(a){return c(null!=a?a.handlers:void 0,a,e)}):f.isPlainObject(d)&&f.isArray(d.handlers)&&f.each(a,function(a){return b(a,d,e)}),e},b=function(a,b,c){var d,e,g,j,k,l,m,n,o;if(j=a.name,g=i.methods,a.expose!==!1&&!g.isFunction(c[j])){for(d=a.handler,m=f(a,"value")?a.value:b.value,l=[a.validator,b.validator,h.validator,function(){return!0}],n=0,o=l.length;o>n&&(k=l[n],!g.isFunction(k));n++);e=function(){return g.isFunction(d)&&k.apply(c,arguments)===!0?d.apply(c,arguments):m},c[j]=e}return c},i.methods={mixin:function(){var a,b,c,d,e,f,g,h,i,j,k;for(a=arguments,g=a.length,k=a[0]||{},f=1,e=!1,"boolean"===this.type(k)&&(e=k,k=a[1]||{},f=2),"object"==typeof k||this.isFunction(k)||(k={}),1===g&&(k=this,f--);g>f;){if(i=a[f],null!=i)for(h in i)c=i[h],j=k[h],c!==k&&(e&&c&&(this.isPlainObject(c)||(d=this.isArray(c)))?(d?(d=!1,b=j&&this.isArray(j)?j:[]):b=j&&this.isPlainObject(j)?j:{},k[h]=this.mixin(e,b,c)):void 0!==c&&(k[h]=c));f++}return k},each:function(a,b){var c,d,e,f;if(this.isArray(a)||this.isArrayLike(a)||this.isString(a))for(d=0;d<a.length&&(c=this.isString(a)?a.charAt(d):a[d],b.apply(c,[c,d++,a])!==!1););else if(this.isObject(a)||this.isFunction(a))for(e in a)if(f=a[e],b.apply(f,[f,e,a])===!1)break;return a},type:function(a){var b;return b=0===arguments.length?null:null==a?String(a):i.types[j.call(a)]||"object"},slice:function(a,b,c){var d,e;return null==a?e=[]:(c=Number(c),d=[Number(b)||0],arguments.length>2&&!isNaN(c)&&d.push(c),e=[].slice.apply(a,d)),e},hasProp:function(a,b){return f.apply(this,[arguments.length<2?this:b,a])},isWindow:function(a){return a&&this.isObject(a)&&"setInterval"in a},isElement:function(a){return a&&this.isObject(a)&&1===a.nodeType},isNumeric:function(a){return!this.isArray(a)&&!isNaN(parseFloat(a))&&isFinite(a)},isInteger:function(a){return this.isNumeric(a)&&/^-?[1-9]\d*$/.test(a)},isPlainObject:function(a){var b,c;if(!a||!this.isObject(a)||a.nodeType||this.isWindow(a))return!1;try{if(a.constructor&&!this.hasProp("constructor",a)&&!this.hasProp("isPrototypeOf",a.constructor.prototype))return!1}catch(d){return b=d,!1}for(c in a);return void 0===c||this.hasProp(c,a)},isEmpty:function(a){var b,c;if(c=!1,null==a||""===a)c=!0;else if((this.isArray(a)||this.isArrayLike(a))&&0===a.length)c=!0;else if(this.isObject(a)){c=!0;for(b in a){c=!1;break}}return c},isArrayLike:function(a){var b,c;return c=!1,this.isObject(a)&&!this.isWindow(a)&&(b=a.length,(1===a.nodeType&&b||!this.isArray(a)&&!this.isFunction(a)&&(0===b||this.isNumber(b)&&b>0&&b-1 in a))&&(c=!0)),c}},g(),E=function(a,b){return c(null!=a?a.handlers:void 0,a,null!=b?b:{})},i.methods.each(i.methods,function(a,b){return E[b]=a}),E}(a),B={}.toString,h=/^[0-9A-Z_.]+[^_.]?$/i,y={regexps:{date:{iso8601:/^(\d{4})\-(\d{2})\-(\d{2})(?:T(\d{2})\:(\d{2})\:(\d{2})(?:(?:\.)(\d{3}))?(Z|[+-]\d{2}\:\d{2})?)?$/},object:{array:/\[(.*)\]/,number:/(-?[0-9]+)/}},modules:{Core:{}}},y.modules.Core.BuiltIn={handlers:function(){var a;a=[];for(w in E)r=E[w],a.push({name:w,handler:r});return a}()},j=function(a,b,c,d){var e,f,g;return g=!1,f=this.isPlainObject(a),(f||d)&&c?g=b===a:(e=f?j.apply(this,[this.keys(a),this.keys(b),!1,!0]):b.length===a.length,e&&this.each(a,function(a){return function(e,f){var h,i,k,l,m,n;return n=a.type(e),k=b[f],a.inArray(n,["string","number","boolean"]>-1)?(i=e+"",l=k+"",m=a.type(k),h=["NaN","Infinity","-Infinity"],g="number"===n&&(a.inArray(i,h)>-1||a.inArray(l,h)>-1)?!1:c===!0?k===e:l===i):a.inArray(n,["null","undefined"])>-1?g=k===e:a.inArray(n,["date","regexp","function"])>-1?g=c?k===e:k.toString()===e.toString():a.inArray(n,["array","object"])>-1?g=j.apply(a,[e,k,c,d]):void 0}}(this))),g},z=function(a){var b,c,d,e;return d=this.isArray(a)?function(){var c,d,e;for(e=[],c=0,d=a.length;d>c;c++)b=a[c],e.push(this.stringify(b));return e}.call(this):function(){var b;b=[];for(c in a)e=a[c],b.push('"'+c+'":'+this.stringify(e));return b}.call(this),d.join(",")},y.modules.Core.Global={handlers:[{name:"extend",handler:function(a,b){return E(a,null!=b?b:this)}},{name:"alias",handler:function(b){return this.isString(b)&&void 0===a[b]&&(a[b]=this),a[String(b)]}},{name:"mask",handler:function(b){var c,d,e;if(this.hasProp(b,a))a.console&&console.error("'"+b+"' has existed as a property of Window object.");else{d=this.__meta__.name,a[b]=a[d];try{e=delete a[d]}catch(f){c=f,a[d]=void 0,e=!0}this.__meta__.name=b}return e},validator:function(a){return this.isString(a)},value:!1},{name:"namespace",handler:function(){var b,c,d;return b=arguments,d={},c=b[0],this.isPlainObject(c)||(c=b[b.length-1]===!0?a:this),this.each(b,function(a){return function(b){var e;return a.isString(b)&&/^[0-9A-Z_.]+[^_.]?$/i.test(b)&&(e=c,a.each(b.split("."),function(b,c,d){return null==e?!1:(a.hasProp(b,e)||(e[b]=c===d.length-1?null:{}),e=e[b],!0)}),d=e),!0}}(this)),d}},{name:"equal",handler:function(a,b,c){var d,e,f,g;return g=!1,d=this.type(a),this.type(b)===d&&(f=this.isPlainObject(a),(f&&this.isPlainObject(b)||"object"!==d)&&(e=this.isArray(a),f||e||(a=[a],b=[b]),this.isBoolean(c)||(c=!1),g=j.apply(this,[a,b,c,e]))),g},validator:function(){return arguments.length>1},value:!1},{name:"random",handler:function(a,b){return null==b&&(b=a,a=0),a+Math.floor(Math.random()*(b-a+1))}},{name:"stringify",handler:function(a){var b,c;switch(this.type(a)){case"object":c=this.isPlainObject(a)?"{"+z.call(this,a)+"}":c="";break;case"array":c="["+z.call(this,a)+"]";break;case"function":case"date":case"regexp":c=a.toString();break;case"string":c='"'+a+'"';break;default:try{c=String(a)}catch(d){b=d,c=""}}return c}}]},y.modules.Core.Object={handlers:[{name:"keys",handler:function(a,b){var c;return c=[],this.each(a,function(a,d){return a===b?(c=d,!1):c.push(d)}),this.isArray(c)?c.sort():c},validator:function(a){var b;return!(null===a||a instanceof Array||"object"!=(b=typeof a)&&"function"!==b)},value:[]}]},u=function(a){return a instanceof Array},v=function(a){return this.isArray(a)||this.isPlainObject(a)},s=function(a,b,c,d,e){var f,g;if(g={value:a,computed:a},v.call(this,c)){if(f=this.isFunction(d),!f&&this.isArray(c)&&c[0]===+c[0]&&c.length<65535)return Math[b].apply(Math,c);this.each(c,function(a,c,h){var i;return i=f?d.apply(e,[a,c,h]):a,"max"===b&&i>g.computed||"min"===b&&i<g.computed?g={value:a,computed:i}:void 0})}return g.value},o=function(a){var b,c;return c=this,b=[],c.isArray(a)?c.each(a,function(a,d){return b=b.concat(o.call(c,a))}):b=a,b},p=function(a){var b;return b=/^([-+]?\d+)\.(\d+)$/,(b.test(a)?(a+"").match(b)[2]:"").length},x=function(a,b,c,d){var e;for(e=[];b>=a;)e.push(d?d(a):a),a+=c;return e},n=function(b,c,d,e,f){var g,h,i,j,k;return j=null,h=this,h.isFunction(c)&&(g="array"===(k=h.type(b))||"string"===k,null==d&&(d=a),h.isFunction(e)&&g?j=e.apply(b,[c,d]):(i=h.isPlainObject(b),i?j={}:g&&(j=[]),null!==j&&h.each(b,function(a,e){var k;return k=c.apply(d,[a,e,h.isString(b)?new String(b):b]),f(j,k,a,e,i,g),!0})),h.isString(b)&&(j=j.join(""))),j},y.modules.Core.Array={value:[],validator:function(a){return u(a)},handlers:[{name:"inArray",handler:function(a,b,c){var d,e,f;if(d=-1,e=Array.prototype.indexOf,f=b.length,c=c?0>c?Math.max(0,f+c):c:0,e)d=e.apply(b,[a,c]);else for(;f>c;){if(c in b&&b[c]===a){d=c;break}c++}return d},validator:function(a,b){return u(b)},value:-1},{name:"filter",handler:function(a,b,c){return n.apply(this,[a,b,c,[].filter,function(a,b,c,d,e,f){if(b){if(e)return a[d]=c;if(f)return a.push(c)}}])},validator:function(a){var b;return u(a)||"object"==(b=typeof a)||"string"===b},value:null},{name:"map",handler:function(a,b,c){return n.apply(this,[a,b,c,[].map,function(a,b,c,d,e,f){return a[d]=b}])},validator:function(a){var b;return u(a)||"object"==(b=typeof a)||"string"===b},value:null},{name:"product",handler:function(a){var b,c,d;return d=1,b=0,c=this,c.each(a,function(a,e){return c.isNumeric(a)?(b++,d*=a):void 0}),0===b?0:d},value:null},{name:"unique",handler:function(a,b){var c,d;return d=[],c=this,b=!!b,c.each(b?a.reverse():a,function(a,b){return c.isNumeric(a)&&(a=parseFloat(a)),-1===c.inArray(a,d)?d.push(a):void 0}),b&&(a.reverse(),d.reverse()),d},value:null},{name:"range",handler:function(a,b,c){var d,e,f,g,h,i,j,k,l;return l=[],i=this,c=i.isNumeric(c)&&1*c>0?1*c:1,i.isNumeric(a)&&i.isNumeric(b)?(f=p(a),h=p(b),g=p(c),e=Math.max(f,h,g),e>0?(e=1*i.zerofill(1,e+1),c*=e,d=function(a){return a/e}):e=1,a*=e,b*=e):(j=/^[a-z]$/,k=/^[A-Z]$/,a+="",b+="",(j.test(a)&&j.test(b)||k.test(a)&&k.test(b))&&(a=a.charCodeAt(0),b=b.charCodeAt(0),d=function(a){return String.fromCharCode(a)})),i.isNumber(a)&&i.isNumber(b)&&(l=a>b?x(b,a,c,d).reverse():b>a?x(a,b,c,d):[d?d(a):a]),l},validator:function(){return!0}},{name:"reduce",handler:function(b,c,d,e){var f,g,h,i,j,k,l;if(j=this,e=!!e,j.isArray(b))if(f=arguments,k=e?[].reduceRight:[].reduce,g=f.length>2,k)l=k.apply(b,g?[c,d]:[c]);else if(h=0,i=b.length,g||(d=b[0],h=1,i--),j.isFunction(c)){for(i=g?i:i+1;i>h;)d=c.apply(a,[d,b[h],h,b]),h++;l=d}return l},value:null},{name:"flatten",handler:function(a){return o.call(this,a)}},{name:"shuffle",handler:function(a){var b,c,d,e;return c=this,e=[],b=0,d=void 0,c.each(a,function(a){return d=c.random(b++),e[b-1]=e[d],e[d]=a,!0}),e},value:null},{name:"sum",handler:function(a){var b;return b=NaN,v.call(this,a)&&(b=0,this.each(a,function(a){return b+=1*a})),b},validator:function(){return!0},value:NaN},{name:"max",handler:function(b,c,d){return s.apply(this,[-(1/0),"max",b,c,arguments.length<3?a:d])},validator:function(){return!0}},{name:"min",handler:function(b,c,d){return s.apply(this,[1/0,"min",b,c,arguments.length<3?a:d])},validator:function(){return!0}},{name:"first",handler:function(a){return this.slice(a,0,1)[0]},validator:function(){return!0}},{name:"last",handler:function(a){return this.slice(a,-1)[0]},validator:function(){return!0}}]},t=function(a,b,c){var d,e,f;for(e=this,d=e.isRegExp(c)?c:new RegExp(c,"ig"),d.global||(d=new RegExp(d.source,"ig")),f=d.exec(a);f;)f.index<b&&(b+=f[0].length),f.lastIndex=0;return a.substring(0,b)},C=function(a){var b,c,d;return c=this,d=[],c.isString(a)&&(d=function(){var d,e,f;for(f=[],d=0,e=a.length;e>d;d++)b=a[d],f.push("\\u"+c.pad(Number(b.charCodeAt(0)).toString(16),4,"0").toUpperCase());return f}()),d.join("")},D=function(b){var c,d,e;return e=b,d=a.btoa,c=a.atob,this.isString(b)&&this.isFunction(d)&&(e=d(unescape(encodeURIComponent(b)))),e},y.modules.Core.String={value:"",validator:function(a){return this.isString(a)},handlers:[{name:"pad",handler:function(a,b,c){var d,e,f;if((this.isString(c)===!1||1!==c.length)&&(c=" "),this.isInteger(b)||(b=0),a=String(a),d=1,f=String(c),e=Math.abs(b)-a.length,e>0){for(;e>d;)c+=f,d++;a=b>0?a+c:c+a}return a},validator:function(a){var b;return"string"==(b=typeof a)||"number"===b}},{name:"capitalize",handler:function(a,b){var c;return c="[a-z]+",a.replace(b===!0?new RegExp(c,"ig"):new RegExp(c),function(a){return a.charAt(0).toUpperCase()+a.slice(1).toLowerCase()})}},{name:"camelCase",handler:function(a,b){var c;return a=a.toLowerCase().replace(/[-_\x20]([a-z]|[0-9])/gi,function(a,b){return b.toUpperCase()}),c=a.charAt(0),a=(b===!0?c.toUpperCase():c.toLowerCase())+a.slice(1)}},{name:"zerofill",handler:function(a,b){var c,d,e,f,g;return f="",d=this,g=/^([-+]?\d+)\.(\d+)$/,c=g.test(a),e="",b=parseInt(b),b>0&&c?(a=(a+"").match(g),e=""+1*a[1]+".",a=a[2]):0>1*a&&(e="-",a=(a+"").substring(1)),f=d.pad(a,b,"0"),f=0>b&&c?"":e+f},validator:function(a,b){return this.isNumeric(a)&&this.isNumeric(b)&&/^-?[1-9]\d*$/.test(b)}},{name:"trim",handler:function(a){var b;return b=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,r="".trim,r&&!r.call("\ufeffÂ ")?r.call(a):a.replace(b,"")}}]},k=function(a){var b,c;return a=this.trim(a),b=new Date(a),isNaN(b.getTime())&&(c=a.match(y.regexps.date.iso8601),b=null!=c?d.call(this,c):new Date),b},d=function(a){var b,c;return a.shift(),b=i.call(this,a),c=A(a.slice(-1)[0]),0!==c&&b.setTime(b.getTime()-c),b},i=function(a){var b,c;return c=["FullYear","Month","Date","Hours","Minutes","Seconds","Milliseconds"],b=new Date,this.each(a,function(a,d){var e;return null!=a&&""!==a&&(e=c[d],null!=e)?b["setUTC"+e](1*a+("Month"===e?-1:0)):void 0}),b},A=function(a){var b,c;return c=0,/^(Z|[+-]\d{2}\:\d{2})$/.test(a)&&(b=a.charAt(0),"Z"!==b&&(c=a.substring(1).split(":"),c=60*(b+(60*c[0]+1*c[1]))*1e3)),c},c={month:{"long":["January","February","March","April","May","June","July","August","September","October","November","December"],"short":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},week:{"long":["Sunday","Monday","Tuesday","Wednesday","Thurday","Friday","Saturday"],"short":["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]}},b={d:function(a){return l.call(this,a.getDate())},D:function(a){return c.week["short"][a.getDay()]},j:function(a){return a.getDate()},l:function(a){return c.week["long"][a.getDay()]},N:function(a){var b;return b=a.getDay(),0===b&&(b=7),b},S:function(a){var b;switch(String(a.getDate()).slice(-1)){case"1":b="st";break;case"2":b="nd";break;case"3":b="rd";break;default:b="th"}return b},w:function(a){return a.getDay()},F:function(a){return c.month["long"][a.getMonth()]},m:function(a){return l.call(this,b.n.call(this,a))},M:function(a){return c.month["short"][a.getMonth()]},n:function(a){return a.getMonth()+1},Y:function(a){return a.getFullYear()},y:function(a){return String(a.getFullYear()).slice(-2)},a:function(a){var b;return b=a.getHours(),b>0&&12>b?"am":"pm"},A:function(a){return b.a.call(this,a).toUpperCase()},g:function(a){var b;return b=a.getHours(),0===b&&(b=24),b>12?b-12:b},G:function(a){return a.getHours()},h:function(a){return l.call(this,b.g.call(this,a))},H:function(a){return l.call(this,b.G.call(this,a))},i:function(a){return l.call(this,a.getMinutes())},s:function(a){return l.call(this,a.getSeconds())}},l=function(a){return this.pad(a,-2,"0")},q=function(a,c){var d,e;return(!this.isDate(c)||isNaN(c.getTime()))&&(c=new Date),d=this,e=a.replace(new RegExp("([a-z]|\\\\)","gi"),function(){var a,e,f,h,i,j;return e=arguments[0],h=4<=arguments.length?g.call(arguments,1,j=arguments.length-2):(j=1,[]),f=arguments[j++],i=arguments[j++],"\\"===e?"":("\\"!==i.charAt(f-1)&&(a=b[e]),null!=a?a.call(d,c):e)})},y.modules.Core.Date={handlers:[{name:"date",handler:function(a,b){return this.isString(b)&&(b=k.call(this,b)),q.apply(this,[a,b])},value:"",validator:function(a){return this.isString(a)}},{name:"now",handler:function(a){var b;return b=new Date,a===!0?b:b.getTime()}}]},f=E(y.modules);try{Object.defineProperty(f,"__meta__",{__proto__:null,writable:!0,value:e})}catch(F){m=F,f.mixin({__meta__:e})}return a[e.name]=f,f}(),d=function(a){var b,c,e,f,g,h;return c=a.hasProp,f=a.isPlainObject,g={},e=function(a){return/^[0-9a-z_.]+[^_.]?$/i.test(a)},h=function(b){var d;return d=g,a.each(b.split("."),function(a){return c(a,d)||(d[a]={}),d=d[a]}),d},b=function(b,d,e){var g,h,i,j;return a.each(d.split("."),function(a){var d;return d=c(a,b),b=b[a],d}),j=this.settings,f(e)||(e={}),g=f(j.keys)?j.keys:{},h=j.formatRegExp,i=j.value(b),a.isRegExp(h)&&(i=i.replace(h,function(b){return function(b,d){var f;return f=c(d,e)?e[d]:c(d,g)?g[d]:b,a.isFunction(f)?f():f}}(this))),i},d=function(){function c(a){this.settings={formatRegExp:null,allowKeys:!1,keys:{},value:function(a){return null!=a?a:""}},this.storage=e(a)?h(""+a):g}return c.prototype.set=function(b){return a.mixin(!0,this.storage,b)},c.prototype.get=function(c,d){var e;return a.isString(c)?e=b.apply(this,[this.storage,c,d]):this.settings.allowKeys===!0&&(e=a.keys(this.storage)),null!=e?e:null},c.prototype.config=function(b){return a.mixin(this.settings,b)},c}()}(f),c=function(b){var d,e,f,g,h,i,j,k,l,m,n,o,p;return l=navigator,p=l.userAgent.toLowerCase(),o={windows:{5.1:"XP",5.2:"XP x64 Edition","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1"}},m=function(){var a;return a=/^[\w.\/]+ \(([^;]+?)[;)]/.exec(p)[1].split(" ").shift(),"compatible"===a?"windows":a},n=function(){var a;return null!=(a=(/windows nt ([\w.]+)/.exec(p)||/os ([\w]+) like mac/.exec(p)||/mac os(?: [a-z]*)? ([\w.]+)/.exec(p)||[])[1])?a.replace(/_/g,"."):void 0},g=function(){var a;return a={touchable:!1,version:n()},a[m()]=!0,a.windows?(a.version=o.windows[a.version],a.touchable=/trident[ \/][\w.]+; touch/.test(p)):(a.ipod||a.iphone||a.ipad)&&(a.touchable=a.ios=!0),a},k=function(){var a,b,c;return a={},b=/(chrome)[ \/]([\w.]+)/.exec(p)||/(webkit)[ \/]([\w.]+)/.exec(p)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(p)||/(msie) ([\w.]+)/.exec(p)||p.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(p)||[],c={browser:b[1]||"",version:b[2]||"0"},c.browser&&(a[c.browser]=!0,a.version=c.version),a.chrome?a.webkit=!0:a.webkit&&(a.safari=!0),a},f=function(){var a,b;return b=/trident.*? rv:([\w.]+)/.exec(p),b?a={msie:!0,version:b[1]}:(a=k(),a.mozilla&&(a.firefox=!0,b=/firefox[ \/]([\w.]+)/.exec(p),b&&(a.version=b[1]))),a.language=navigator.language||navigator.browserLanguage,a},e=function(a){var b,c;try{b=new ActiveXObject(a)}catch(d){c=d,b=null}return b},j=function(){var c;return b.hasProp("ActiveXObject",a)&&(c=e("AcroPDF.PDF"),c||(c=e("PDF.PdfCtrl"))),null!=c},i=function(){var a;return a=!1,b.each(l.plugins,function(b){return a=/Adobe Reader|Adobe PDF|Acrobat/gi.test(b.name),!a}),a},h=function(){var a;return null!=(null!=(a=l.mimeTypes["application/pdf"])?a.enabledPlugin:void 0)},d=function(){return i()||j()||h()},c=function(){function a(){this.platform=g(),this.browser=f(),this.plugins={pdf:d()}}return a}()}(f),e=function(a,b){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_;return n=1,h=2,u=3,i=4,p=5,o=6,s=7,j=8,l=9,m=10,k=11,r=12,t=/^[0-9A-Z_.]+[^_.]?$/i,f=jQuery,_={lang:document.documentElement.lang||document.documentElement.getAttribute("lang")||navigator.language||navigator.browserLanguage},e=b,$={storage:!!a.localStorage},L={key:{storage:["sandboxStarted","config","fn","buffer","pool"]}},X={sandboxStarted:!1,config:{debug:!0,platform:"",locale:_.lang,lang:_.lang.split("-")[0]},fn:{prepare:[],ready:[],init:{ajaxHandler:function(a,b){return{success:function(c,d,g){var h;if(h=e.slice(arguments),c.code>0){if(e.isFunction(a))return a.apply(f,h)}else if(e.isFunction(b))return b.apply(f,h)},error:f.noop}}},handler:{}},modules:{utils:{},flow:{},project:{},storage:{},request:{},HTML:{},URL:{}},buffer:{},pool:{}},J=function(a){return e.slice(a,-1)[0]},W=function(){return f.ajaxSetup({type:"post",dataType:"json"}),f(document).ajaxError(function(a,b,c,d){var e;return e=b.responseText,!1})},z=function(){var a,b,c,d;return a=arguments,d=a[0],c=a[1],b=X.fn.handler,0===a.length?c=A(b):e.isString(d)?e.isFunction(c)?b[d]=c:c=b[d]:e.isPlainObject(d)&&(c={},e.each(d,function(a,d){return e.isFunction(a)?c[d]=b[d]=a:void 0})),c},N=function(a){var b,c,d;if(c=X.fn.handler,e.isString(a))if(e.hasProp(a,c))try{d=delete c[a]}catch(f){b=f,c[a]=void 0,d=!0}else d=!1;else e.each(a,function(a,b){return d=N(a)});return d},T=function(b){var c,d,f,g;if(d=void 0,e.isArray(b))for(f=0,g=b.length;g>f;f++)c=b[f],(e.isFunction(c)||e.isFunction(c=X.fn.handler[c]))&&c.call(a);else e.isString(b)&&(c=X.fn.handler[b],e.isFunction(c)&&(d=c.apply(a,e.slice(arguments,1))));return d},M=function(a,b){return e.isFunction(a)?X.fn[b].push(a):void 0},A=function(a){var b;return b=null,e.isArray(a)||void 0!==a.length?b=[].concat([],e.slice(a)):e.isPlainObject(a)&&(b=f.extend(!0,{},a)),b},G=function(a){return X.fn.init[a]},E=function(a,b){var c,d;return c=a.split("."),d=null,(b||!I(c[0],L.key.storage))&&(d=X,e.each(c,function(a){var b;return b=e.hasProp(a,d),d=d[a],b})),d},V=function(a,b){var c,d,f,g,h;return g=a.split("."),f=g.length,c=e.isPlainObject(b),1===f?(d=g[0],h=U(X,d,b,e.hasProp(d,X))):(h=X,e.each(g,function(a,c){return f-1>c?e.hasProp(a,h)||(h[a]={}):h[a]=U(h,a,b,e.isPlainObject(h[a])),h=h[a],!0})),h},U=function(a,b,c,d){return d&&e.isPlainObject(c)?f.extend(!0,a[b],c):a[b]=c,a[b]},H=function(a,b,c){return e.isObject(a)&&e.isString(b)&&e.hasProp(b,a)&&e.type(a[b])===c},I=function(a,b){return f.inArray(a,b)>-1},K=function(a){return L.key.storage.push(a)},D=function(){var a,b;a={Storage:d};try{return Object.defineProperty(e,"__class__",{__proto__:null,value:a})}catch(c){return b=c,e.mixin({__class__:a})}},X.modules.handler={handlers:[{name:"queue",handler:function(){return z.apply(a,this.slice(arguments))}},{name:"dequeue",handler:N,validator:function(a){return this.isString(a)||this.isArray(a)},value:!1},{name:"run",handler:function(){return T.apply(a,this.slice(arguments))}},{name:"functionExists",handler:function(b,c){return H(c===!0?a:X.fn.handler,b,"function")}}]},X.fn.init.runSandbox=function(a,b){return T(a),f(document).ready(function(){return T(b)})},P=function(a){return A(e.isPlainObject(a)?f.extend(X.config,a):X.config)},X.modules.execution={handlers:[{name:"sandbox",handler:function(a){var b;return b=P(a),G("runSandbox").apply(this,[X.fn.prepare,X.fn.ready]),X.sandboxStarted=!0,b||!1},value:!1,validator:function(){return X.sandboxStarted!==!0}},{name:"prepare",handler:function(a){return M(a,"prepare")}},{name:"ready",handler:function(a){return M(a,"ready")}}]},X.web_api={},X.config.api="",X.fn.init.apiNS=function(a){},q=new d("I18n"),q.config({formatRegExp:/\{%\s*([A-Z0-9_]+)\s*%\}/gi,value:function(a){return e.isString(a)?a:""}}),g=new d("Web_API"),g.config({formatRegExp:/\:([a-z_]+)/g,value:function(a){var b;return null!=(b=w()+a)?b:""}}),R=new d("route"),R.config({formatRegExp:/\:([a-z_]+)/g}),x=new d("asset"),F=function(){var a,b,c;return a=arguments,b=a[0],c=a[1],e.isPlainObject(b)?e.each(b,F):e.isString(c)&&e.hasProp(c,X.fn.init)&&e.isFunction(b)?X.fn.init[c]=b:void 0},w=function(){var a;return a=e.config("api"),e.isString(a)&&""!==e.trim(a)?"/"+a:""},Y=function(a,b,c){var d,f,h;switch(a){case"api":f=g,d=function(a){var b;return null!=(b=G("apiNS")(a))?b:a};break;case"route":f=R;break;case"asset":f=x}return e.isPlainObject(b)?f.set(b):e.isString(b)&&(h=f.get(null!=d?d(b):b,c)),null!=h?h:null},v=function(a,b){return Y("api",a,b)},S=function(a,b){return Y("route",a,b)},y=function(a){return Y("asset",a)},X.modules.configuration={handlers:[{name:"config",handler:function(a){return this.isString(a)?X.config[a]:A(X.config)}},{name:"init",handler:function(){return F.apply(a,this.slice(arguments))}},{name:"i18n",handler:function(a,b){var c,d;return c=arguments,this.isPlainObject(a)?q.set(a):t.test(a)&&(2===c.length&&this.isString(b)&&!t.test(b)||(this.isPlainObject(b)?d=q.get(a,b):(d="",this.each(c,function(a){return e.isString(a)&&t.test(a)?d+=q.get(a):void 0})))),null!=d?d:null}},{name:"api",handler:v},{name:"route",handler:S},{name:"asset",handler:y}]},C=function(a){var b,c;return b={},c=a.match(/<[a-z]+[^>]*>/i),null!==c&&e.each(c[0].match(/(data(-[a-z]+)+=[^\s>]*)/gi)||[],function(a){return a=a.match(/data-(.*)="([^\s"]*)"/i),b[e.camelCase(a[1])]=a[2],!0}),b},B=function(a){var b;return b={},e.each(a,function(a){var c;return a.nodeType===h&&(c=a.nodeName.match(/^data-(.*)$/i))&&(b[e.camelCase(c(1))]=a.nodeValue),!0}),b},X.modules.storage={handlers:[{name:"data",handler:function(){var a,b,c,d,e,g;if(a=arguments,c=a.length,c>0){g=a[0];try{d=f(g).get(0)}catch(h){b=h,d=g}d&&d.nodeType===n?(e={},d.dataset?e=d.dataset:d.outerHTML?e=C(d.outerHTML):d.attributes&&f.isNumeric(d.attributes.length)&&(e=B(d.attributes))):this.isString(g)&&t.test(g)&&(e=1===c?E(g):V(g,a[1]),c>1&&J(a)===!0&&K(g.split(".")[0]))}return null!=e?e:null}},{name:"save",handler:function(){var a,b,c,d;a=arguments,b=a[0],d=a[1],$.storage&&this.isString(b)&&(c=this.access(b),localStorage.setItem(b,escape(this.stringify(this.isPlainObject(c)&&this.isPlainObject(d)?this.mixin(!0,c,d):d))))},validator:function(){return arguments.length>1}},{name:"access",handler:function(){var a,b,c;if(b=arguments[0],$.storage)if(c=localStorage.getItem(b),null!=c)if("undefined"===c)c=void 0;else if("null"===c)c=null;else{c=unescape(c);try{c=JSON.parse(c)}catch(d){a=d,c=c}}else c=void 0;return c},value:void 0,validator:function(a){return this.isString(a)}}]},O=function(a,b,c,d){var g;if(0!==arguments.length)return e.isPlainObject(a)===!1&&(a={url:a}),g=G("ajaxHandler")(b,c),e.isFunction(a.success)||(a.success=g.success),e.isFunction(a.error)||(a.error=g.error),f.ajax(f.extend(a,{async:d!==!0}))},X.modules.request={handlers:[{name:"ajax",handler:function(a,b,c){return O(a,b,c)}},{name:"sjax",handler:function(a,b,c){return O(a,b,c,!0)}}]},Q=function(a){return"/"===a.charAt(0)?a:"/"+a},Z=function(a){var b;return b={},e.each(a.split("&"),function(a){return a=a.split("="),""!==e.trim(a[0])?b[a[0]]=a[1]:void 0}),b},X.modules.URL={handlers:[{name:"pathname",handler:function(a){return Q(this.isString(a)?a:location.pathname)}},{name:"url",handler:function(){var b,c,d;return c=a.location,d=c.search.slice(1),b=c.hash.slice(1),{search:d,hash:b,query:Z(d),hashMap:Z(b)}}},{name:"download",handler:function(b,c){var d,e,f;return a.ActiveXObject?a.ActiveXObject&&document.execCommand?(f=a.open(b,"_blank"),f.document.close(),f.document.execCommand("SaveAs",!0,c||b),f.close()):void 0:(e=document.createElement("a"),e.href=b,e.target="_blank",e.download=c||"unknown",d=document.createEvent("Event"),d.initEvent("click",!0,!0),e.dispatchEvent(d),(a.URL||a.webkitURL).revokeObjectURL(e.href))}}]},e.extend(X.modules,e),e.api.formatList=function(a){return e.isPlainObject(a)?g.config({keys:a}):void 0},e.route.formatList=function(a){return e.isPlainObject(a)?R.config({keys:a}):void 0},e.mixin(new c),D(),e}(a,f),e.mask("Tatami"),e.mixin(e.__meta__,{name:"Tatami",version:"0.2.3"})});