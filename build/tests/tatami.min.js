/*!
 * Tatami v0.3.0
 * http://ourai.github.io/tatami/
 *
 * Copyright 2013, 2014 Ourairyu, http://ourai.ws/
 *
 * Date: 2014-07-01
 */

!function(a,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("Requires a window with a document");return b(a)}:b(a)}("undefined"!=typeof window?window:this,function(a){"use strict";var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$=[].slice;n={name:"Tatami",version:"0.3.0"},Y=function(a){var b,c,d,e,f,g,h,i;return i={}.toString,g={validator:function(){return!0}},h={types:{}},f=function(){var a,b,c,d,e;for(b="Boolean Number String Function Array Date RegExp Object".split(" "),c=function(a){var b;return h.types["[object "+a+"]"]=b=a.toLowerCase(),h.methods["is"+a]=function(a){return this.type(a)===b}},d=0,e=b.length;e>d;d++)a=b[d],c(a);return h.types},e=function(a,b){return null==a?!1:Object.prototype.hasOwnProperty.call(a,b)},d=function(a){var b,c,d;c="__"+n.name.toLowerCase()+"__",d=!0;try{Object.defineProperty(a,c,{__proto__:null,value:d})}catch(e){b=e,a[c]=d}return!0},c=function(a,d,e){var f;return f=h.methods,f.isArray(d)||f.isPlainObject(d)&&!f.isArray(d.handlers)?f.each(d,function(a){return c(null!=a?a.handlers:void 0,a,e)}):f.isPlainObject(d)&&f.isArray(d.handlers)&&f.each(a,function(a){return b(a,d,e)}),e},b=function(a,b,c){var d,f,i,j,k,l,m,n,o;if(j=a.name,i=h.methods,a.expose!==!1&&!i.isFunction(c[j])){for(d=a.handler,m=e(a,"value")?a.value:b.value,l=[a.validator,b.validator,g.validator,function(){return!0}],n=0,o=l.length;o>n&&(k=l[n],!i.isFunction(k));n++);f=function(){return i.isFunction(d)&&k.apply(c,arguments)===!0?d.apply(c,arguments):m},c[j]=f}return c},h.methods={mixin:function(){var a,b,c,d,e,f,g,h;for(a=arguments,d=a.length,g=null!=(h=a[0])?h:{},c=1,1===d&&(g=this,c--);d>c;){if(f=a[c],"object"==typeof f)for(e in f)b=f[e],b!==g&&void 0!==b&&(g[e]=b);c++}return g},each:function(a,b){var c,d,e,f;if(this.isArray(a)||this.isArrayLike(a)||this.isString(a))for(d=0;d<a.length&&(c=this.isString(a)?a.charAt(d):a[d],b.apply(c,[c,d++,a])!==!1););else if(this.isObject(a)||this.isFunction(a))for(e in a)if(f=a[e],b.apply(f,[f,e,a])===!1)break;return a},type:function(a){return null==a?String(a):h.types[i.call(a)]||"object"},slice:function(a,b){return null==a?[]:[].slice.call(a,Number(b)||0)},hasProp:function(b,c){return e.apply(this,[arguments.length<2?a:c,b])},isWindow:function(a){return a&&this.isObject(a)&&"setInterval"in a},isElement:function(a){return a&&this.isObject(a)&&1===a.nodeType},isNumeric:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},isInteger:function(a){return this.isNumeric(a)&&/^-?[1-9]\d*$/.test(a)},isPlainObject:function(a){var b,c;if(!a||!this.isObject(a)||a.nodeType||this.isWindow(a))return!1;try{if(a.constructor&&!this.hasProp("constructor",a)&&!this.hasProp("isPrototypeOf",a.constructor.prototype))return!1}catch(d){return b=d,!1}for(c in a);return void 0===c||this.hasProp(c,a)},isEmpty:function(a){var b,c;if(c=!1,null==a||""===a)c=!0;else if((this.isArray(a)||this.isArrayLike(a))&&0===a.length)c=!0;else if(this.isObject(a)){c=!0;for(b in a){c=!1;break}}return c},isArrayLike:function(a){var b,c;return c=!1,this.isObject(a)&&null!==a&&(this.isWindow(a)||(b=a.length,(1===a.nodeType&&b||!this.isArray(a)&&!this.isFunction(a)&&(0===b||this.isNumber(b)&&b>0&&b-1 in a))&&(c=!0))),c}},f(),Y=function(a,b){return c(null!=a?a.handlers:void 0,a,null!=b?b:{})},h.methods.each(h.methods,function(a,b){return Y[b]=a}),Y}(a),Z=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B;z={}.toString,f=/^[0-9A-Z_.]+[^_.]?$/i,w={regexps:{date:{iso8601:/^(\d{4})\-(\d{2})\-(\d{2})(?:T(\d{2})\:(\d{2})\:(\d{2})(?:(?:\.)(\d{3}))?(Z|[+-]\d{2}\:\d{2})?)?$/},object:{array:/\[(.*)\]/,number:/(-?[0-9]+)/}},modules:{Core:{}}},w.modules.Core.BuiltIn={handlers:function(){var a;a=[];for(u in b)p=b[u],a.push({name:u,handler:p});return a}()},h=function(a,b,c,d){var e,f,g,i;return i=!1,f=this,g=f.isPlainObject(a),(g||d)&&c?i=b===a:(e=g?h.apply(f,[f.keys(a),f.keys(b),!1,!0]):b.length===a.length,e&&f.each(a,function(a,e){var g;return g=f.type(a),f.inArray(g,["string","number","boolean","null","undefined"])>-1?i=b[e]===a:f.inArray(g,["date","regexp","function"])>-1?i=c?b[e]===a:b[e].toString()===a.toString():f.inArray(g,["array","object"])>-1?i=h.apply(f,[a,b[e],c,d]):void 0})),i},x=function(a){var b,c,d,e;return d=this.isArray(a)?function(){var c,d,e;for(e=[],c=0,d=a.length;d>c;c++)b=a[c],e.push(this.stringify(b));return e}.call(this):function(){var b;b=[];for(c in a)e=a[c],b.push('"'+c+'":'+this.stringify(e));return b}.call(this),d.join(",")},w.modules.Core.Global={handlers:[{name:"extend",handler:function(a,c){return b(a,c)}},{name:"alias",handler:function(b){return this.isString(b)&&void 0===a[b]&&(a[b]=this),a[String(b)]}},{name:"mask",handler:function(b){var c,d,e;if(this.hasProp(b))a.console&&console.error("'"+b+"' has existed as a property of Window object.");else{d=this.__meta__.name,a[b]=a[d];try{e=delete a[d]}catch(f){c=f,a[d]=void 0,e=!0}this.__meta__.name=b}return e},validator:function(a){return this.isString(a)},value:!1},{name:"namespace",handler:function(){var b,c,d,e;return b=arguments,d=this,e={},c=b[0],d.isPlainObject(c)||(c=b[b.length-1]===!0?a:this),d.each(b,function(a){var b;return d.isString(a)&&/^[0-9A-Z_.]+[^_.]$/i.test(a)&&(b=c,d.each(a.split("."),function(a,c,d){return void 0===b[a]&&(b[a]=c===d.length-1?null:{}),b=b[a],!0}),e=b),!0}),e}},{name:"equal",handler:function(a,b,c){var d,e,f,g,i;return g=!1,e=this,i=e.type(a),e.type(b)===i&&(f=e.isPlainObject(a),(f&&e.isPlainObject(b)||"object"!==i)&&(d=e.isArray(a),f||d||(a=[a],b=[b]),e.isBoolean(c)||(c=!1),g=h.apply(e,[a,b,c,d]))),g}},{name:"random",handler:function(a,b){return null==b&&(b=a,a=0),a+Math.floor(Math.random()*(b-a+1))}},{name:"stringify",handler:function(a){var b,c,d;if(d=this.type(a),"object"===d)if(this.isPlainObject(a))try{c=JSON.stringify(a)}catch(e){b=e,c="{"+x.call(this,a)+"}"}else c="";else switch(d){case"array":c="["+x.call(this,a)+"]";break;case"function":case"date":case"regexp":c=a.toString();break;case"string":c='"'+a+'"';break;default:try{c=String(a)}catch(e){b=e,c=""}}return c}},{name:"parse",handler:function(a){var b;return a=this.trim(a),b=a,this.each(w.regexps.object,function(c){return function(d,e){var f,g,h;if(h=new RegExp("^"+d.source+"$"),h.test(a)){switch(e){case"array":for(g=new RegExp(""+d.source,"g"),f=/(\[.*\])/,d=g.exec(a),b=[];null!=d;){c.each(d[1].split(","),function(a){return b.push(c.parse(a))});break}break;case"number":b*=1}return!1}return!0}}(this)),b},validator:function(a){return this.isString(a)},value:"",expose:!1}]},w.modules.Core.Object={handlers:[{name:"keys",handler:function(a,b){var c;return c=[],this.each(a,function(a,d){return a===b?(c=d,!1):c.push(d)}),this.isArray(c)?c.sort():c},validator:function(a){var b;return!(null===a||a instanceof Array||"object"!=(b=typeof a)&&"function"!==b)},value:[]}]},s=function(a){return a instanceof Array},t=function(a){return this.isArray(a)||this.isPlainObject(a)},q=function(a,b,c,d,e){var f,g;if(g={value:a,computed:a},t.call(this,c)){if(f=this.isFunction(d),!f&&this.isArray(c)&&c[0]===+c[0]&&c.length<65535)return Math[b].apply(Math,c);this.each(c,function(a,c,h){var i;return i=f?d.apply(e,[a,c,h]):a,"max"===b&&i>g.computed||"min"===b&&i<g.computed?g={value:a,computed:i}:void 0})}return g.value},m=function(a){var b,c;return c=this,b=[],c.isArray(a)?c.each(a,function(a){return b=b.concat(m.call(c,a))}):b=a,b},n=function(a){var b;return b=/^([-+]?\d+)\.(\d+)$/,(b.test(a)?(a+"").match(b)[2]:"").length},v=function(a,b,c,d){var e;for(e=[];b>=a;)e.push(d?d(a):a),a+=c;return e},l=function(b,c,d,e,f){var g,h,i,j,k;return j=null,h=this,h.isFunction(c)&&(g="array"===(k=h.type(b))||"string"===k,null==d&&(d=a),h.isFunction(e)&&g?j=e.apply(b,[c,d]):(i=h.isPlainObject(b),i?j={}:g&&(j=[]),null!==j&&h.each(b,function(a,e){var k;return k=c.apply(d,[a,e,h.isString(b)?new String(b):b]),f(j,k,a,e,i,g),!0})),h.isString(b)&&(j=j.join(""))),j},w.modules.Core.Array={value:[],validator:function(a){return s(a)},handlers:[{name:"inArray",handler:function(a,b,c){var d,e,f;if(d=-1,e=Array.prototype.indexOf,f=b.length,c=c?0>c?Math.max(0,f+c):c:0,e)d=e.apply(b,[a,c]);else for(;f>c;){if(c in b&&b[c]===a){d=c;break}c++}return d},validator:function(a,b){return s(b)},value:-1},{name:"filter",handler:function(a,b,c){return l.apply(this,[a,b,c,[].filter,function(a,b,c,d,e,f){if(b){if(e)return a[d]=c;if(f)return a.push(c)}}])},validator:function(a){var b;return s(a)||"object"==(b=typeof a)||"string"===b},value:null},{name:"map",handler:function(a,b,c){return l.apply(this,[a,b,c,[].map,function(a,b,c,d){return a[d]=b}])},validator:function(a){var b;return s(a)||"object"==(b=typeof a)||"string"===b},value:null},{name:"product",handler:function(a){var b,c,d;return d=1,b=0,c=this,c.each(a,function(a){return c.isNumeric(a)?(b++,d*=a):void 0}),0===b?0:d},value:null},{name:"unique",handler:function(a,b){var c,d;return d=[],c=this,b=!!b,c.each(b?a.reverse():a,function(a){return c.isNumeric(a)&&(a=parseFloat(a)),-1===c.inArray(a,d)?d.push(a):void 0}),b&&(a.reverse(),d.reverse()),d},value:null},{name:"range",handler:function(a,b,c){var d,e,f,g,h,i,j,k,l;return l=[],i=this,c=i.isNumeric(c)&&1*c>0?1*c:1,i.isNumeric(a)&&i.isNumeric(b)?(f=n(a),h=n(b),g=n(c),e=Math.max(f,h,g),e>0?(e=1*i.zerofill(1,e+1),c*=e,d=function(a){return a/e}):e=1,a*=e,b*=e):(j=/^[a-z]$/,k=/^[A-Z]$/,a+="",b+="",(j.test(a)&&j.test(b)||k.test(a)&&k.test(b))&&(a=a.charCodeAt(0),b=b.charCodeAt(0),d=function(a){return String.fromCharCode(a)})),i.isNumber(a)&&i.isNumber(b)&&(l=a>b?v(b,a,c,d).reverse():b>a?v(a,b,c,d):[d?d(a):a]),l},validator:function(){return!0}},{name:"reduce",handler:function(b,c,d,e){var f,g,h,i,j,k,l;if(j=this,e=!!e,j.isArray(b))if(f=arguments,k=e?[].reduceRight:[].reduce,g=f.length>2,k)l=k.apply(b,g?[c,d]:[c]);else if(h=0,i=b.length,g||(d=b[0],h=1,i--),j.isFunction(c)){for(i=g?i:i+1;i>h;)d=c.apply(a,[d,b[h],h,b]),h++;l=d}return l},value:null},{name:"flatten",handler:function(a){return m.call(this,a)}},{name:"shuffle",handler:function(a){var b,c,d,e;return c=this,e=[],b=0,d=void 0,c.each(a,function(a){return d=c.random(b++),e[b-1]=e[d],e[d]=a,!0}),e},value:null},{name:"sum",handler:function(a){var b;return b=0/0,t.call(this,a)&&(b=0,this.each(a,function(a){return b+=1*a})),b},validator:function(){return!0},value:0/0},{name:"max",handler:function(b,c,d){return q.apply(this,[-1/0,"max",b,c,arguments.length<3?a:d])},validator:function(){return!0}},{name:"min",handler:function(b,c,d){return q.apply(this,[1/0,"min",b,c,arguments.length<3?a:d])},validator:function(){return!0}}]},r=function(a,b,c){var d,e,f;for(e=this,d=e.isRegExp(c)?c:new RegExp(c,"ig"),d.global||(d=new RegExp(d.source,"ig")),f=d.exec(a);f;)f.index<b&&(b+=f[0].length),f.lastIndex=0;return a.substring(0,b)},A=function(a){var b,c,d;return c=this,d=[],c.isString(a)&&(d=function(){var d,e,f;for(f=[],d=0,e=a.length;e>d;d++)b=a[d],f.push("\\u"+c.pad(Number(b.charCodeAt(0)).toString(16),4,"0").toUpperCase());return f}()),d.join("")},B=function(b){var c,d,e;return e=b,d=a.btoa,c=a.atob,this.isString(b)&&this.isFunction(d)&&(e=d(unescape(encodeURIComponent(b)))),e},w.modules.Core.String={value:"",validator:function(a){return this.isString(a)},handlers:[{name:"pad",handler:function(a,b,c){var d,e,f;if((this.isString(c)===!1||1!==c.length)&&(c=" "),this.isInteger(b)||(b=0),a=String(a),d=1,f=String(c),e=Math.abs(b)-a.length,e>0){for(;e>d;)c+=f,d++;a=b>0?a+c:c+a}return a},validator:function(a){var b;return"string"==(b=typeof a)||"number"===b}},{name:"capitalize",handler:function(a,b){var c;return c="[a-z]+",a.replace(b===!0?new RegExp(c,"ig"):new RegExp(c),function(a){return a.charAt(0).toUpperCase()+a.slice(1).toLowerCase()})}},{name:"camelCase",handler:function(a,b){var c;return a=a.toLowerCase().replace(/[-_\x20]([a-z]|[0-9])/gi,function(a,b){return b.toUpperCase()}),c=a.charAt(0),a=(b===!0?c.toUpperCase():c.toLowerCase())+a.slice(1)}},{name:"zerofill",handler:function(a,b){var c,d,e,f,g;return f="",d=this,g=/^([-+]?\d+)\.(\d+)$/,c=g.test(a),e="",b=parseInt(b),b>0&&c?(a=(a+"").match(g),e=""+1*a[1]+".",a=a[2]):0>1*a&&(e="-",a=(a+"").substring(1)),f=d.pad(a,b,"0"),f=0>b&&c?"":e+f},validator:function(a,b){return this.isNumeric(a)&&this.isNumeric(b)&&/^-?[1-9]\d*$/.test(b)}},{name:"trim",handler:function(a){var b;return b=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,p="".trim,p&&!p.call("﻿ ")?p.call(a):a.replace(b,"")}},{name:"substr",handler:function(a,b,c,d){var e,f;return e=arguments,f=this,3===e.length&&f.isNumeric(b)&&b>0&&(f.isString(c)||f.isRegExp(c))?a=r.apply(f,[a,b,c]):f.isNumeric(b)&&b>=0&&((!f.isNumeric(c)||0>=c)&&(c=a.length),a=f.isString(d)||f.isRegExp(d)?r.apply(f,[a.substring(b),c,d]):a.substring(b,c)),a}},{name:"countChars",handler:function(a,b){var c,d,e,f;switch(f=null,e=this,(!e.isInteger(b)||0>b)&&(b=0),c={},d=[],e.each(a,function(a){var b;return b=a.charCodeAt(0),e.isNumber(c[b])?c[b]++:(c[b]=1,e.inArray(a,d)<0?d.push(a):void 0)}),b){case 0:break;case 1:f=c;break;case 2:break;case 3:f=d.join("");break;case 4:}return f},value:null}]},i=function(a){var b,c;return a=this.trim(a),b=new Date(a),isNaN(b.getTime())&&(c=a.match(w.regexps.date.iso8601),b=null!=c?e.call(this,c):new Date),b},e=function(a){var b,c;return a.shift(),b=g.call(this,a),c=y(a.slice(-1)[0]),0!==c&&b.setTime(b.getTime()-c),b},g=function(a){var b,c;return c=["FullYear","Month","Date","Hours","Minutes","Seconds","Milliseconds"],b=new Date,this.each(a,function(a,d){var e;return null!=a&&""!==a&&(e=c[d],null!=e)?b["setUTC"+e](1*a+("Month"===e?-1:0)):void 0}),b},y=function(a){var b,c;return c=0,/^(Z|[+-]\d{2}\:\d{2})$/.test(a)&&(b=a.charAt(0),"Z"!==b&&(c=a.substring(1).split(":"),c=60*(b+(60*c[0]+1*c[1]))*1e3)),c},d={month:{"long":["January","February","March","April","May","June","July","August","September","October","November","December"],"short":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},week:{"long":["Sunday","Monday","Tuesday","Wednesday","Thurday","Friday","Saturday"],"short":["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]}},c={d:function(a){return j.call(this,a.getDate())},D:function(a){return d.week.short[a.getDay()]},j:function(a){return a.getDate()},l:function(a){return d.week.long[a.getDay()]},N:function(a){var b;return b=a.getDay(),0===b&&(b=7),b},S:function(a){var b;switch(String(a.getDate()).slice(-1)){case"1":b="st";break;case"2":b="nd";break;case"3":b="rd";break;default:b="th"}return b},w:function(a){return a.getDay()},F:function(a){return d.month.long[a.getMonth()]},m:function(a){return j.call(this,c.n.call(this,a))},M:function(a){return d.month.short[a.getMonth()]},n:function(a){return a.getMonth()+1},Y:function(a){return a.getFullYear()},y:function(a){return String(a.getFullYear()).slice(-2)},a:function(a){var b;return b=a.getHours(),b>0&&12>b?"am":"pm"},A:function(a){return c.a.call(this,a).toUpperCase()},g:function(a){var b;return b=a.getHours(),0===b&&(b=24),b>12?b-12:b},G:function(a){return a.getHours()},h:function(a){return j.call(this,c.g.call(this,a))},H:function(a){return j.call(this,c.G.call(this,a))},i:function(a){return j.call(this,a.getMinutes())},s:function(a){return j.call(this,a.getSeconds())}},j=function(a){return this.pad(a,-2,"0")},o=function(a,b){var d,e;return(!this.isDate(b)||isNaN(b.getTime()))&&(b=new Date),d=this,e=a.replace(new RegExp("([a-z]|\\\\)","gi"),function(){var a,e,f,g,h,i;return e=arguments[0],g=4<=arguments.length?$.call(arguments,1,i=arguments.length-2):(i=1,[]),f=arguments[i++],h=arguments[i++],"\\"===e?"":("\\"!==h.charAt(f-1)&&(a=c[e]),null!=a?a.call(d,b):e)})},w.modules.Core.Date={handlers:[{name:"date",handler:function(a,b){return this.isString(b)&&(b=i.call(this,b)),o.apply(this,[a,b])},value:"",validator:function(a){return this.isString(a)}},{name:"now",handler:function(a){var b;return b=new Date,a===!0?b:b.getTime()}}]},Z=b(w.modules);try{Object.defineProperty(Z,"__meta__",{__proto__:null,writable:!0,value:{name:"__util",version:""}})}catch(C){k=C,Z.mixin({__meta__:{name:"__util",version:""}})}return Z}(a,Y),r=function(a){var b,c,d,e,f,g;return c=a.hasProp,e=a.isPlainObject,f={},d=function(a){return/^[0-9a-z_.]+[^_.]?$/i.test(a)},g=function(b){var d;return d=f,a.each(b.split("."),function(a){return c(a,d)||(d[a]={}),d=d[a]}),d},b=function(b,d,f){var g,h,i;return a.each(d.split("."),function(a){var d;return d=c(a,b),b=b[a],d}),i=this.settings,e(f)||(f={}),g=e(i.keys)?i.keys:{},h=i.value(b).replace(i.format_regexp,function(){return function(a,b){var d;return d=c(b,f)?f[b]:c(b,g)?g[b]:a}}(this))},r=function(){function c(a){this.settings={format_regexp:/.*/g,allow_keys:!1,keys:{},value:function(a){return null!=a?a:""}},this.storage=d(a)?g(""+a):f}return c.prototype.set=function(b){return a.mixin(this.storage,b)},c.prototype.get=function(c,d){var e;return a.isString(c)?e=b.apply(this,[this.storage,c,d]):this.settings.allow_keys===!0&&(e=a.keys(this.storage)),null!=e?e:null},c.prototype.config=function(b){return a.mixin(this.settings,b)},c}()}(Z),j=1,d=2,s=3,e=4,l=5,k=6,p=7,f=8,h=9,i=10,g=11,o=12,q=/^[0-9A-Z_.]+[^_.]?$/i,b=jQuery,W={lang:document.documentElement.lang||document.documentElement.getAttribute("lang")||navigator.language||navigator.browserLanguage},X=Z,X.mask(n.name),X.__meta__=n,T={storage:!!a.localStorage},G={key:{storage:["sandboxStarted","config","fn","buffer","pool","i18n"]}},R={sandboxStarted:!1,config:{debug:!0,platform:"",locale:W.lang,lang:W.lang.split("-")[0]},fn:{prepare:[],ready:[],init:{systemDialog:b.noop,ajaxHandler:function(a,c){return{success:function(d){var e;return e=X.slice(arguments),d.code>0?X.isFunction(a)?a.apply(b,e):void 0:X.isFunction(c)?c.apply(b,e):U("alert",d.message)},error:b.noop}}},handler:{}},modules:{utils:{},flow:{},project:{},storage:{},request:{},HTML:{},URL:{}},buffer:{},pool:{},i18n:{_SYS:{dialog:{zh:{title:"系统提示",close:"关闭",ok:"确定",cancel:"取消",yes:"是",no:"否"},en:{title:"System",close:"Close",ok:"Ok",cancel:"Cancel",yes:"Yes",no:"No"}}}}},E=function(a){return X.slice(a,-1)[0]},Q=function(){return b.ajaxSetup({type:"post",dataType:"json"}),b(document).ajaxError(function(a,b){var c;return c=b.responseText,!1})},U=function(c,d,e,f){var g,h,i,j;return j=!1,X.isString(c)&&(c=c.toLowerCase(),X.isFunction(b.fn.dialog)?(i="systemDialog",h=R.i18n._SYS.dialog[X.config("lang")],X.hasProp(i,R.pool)||(R.pool[i]={}),g=R.pool[i][c],g||(g=b('<div data-role="dialog" data-type="system" />').appendTo(b("body")).on({dialogcreate:B("systemDialog"),dialogopen:function(){return b(".ui-dialog-buttonset .ui-button",b(this).closest(".ui-dialog")).each(function(){var a;switch(a=b(this),X.trim(a.text())){case h.ok:c="ok";break;case h.cancel:c="cancel";break;case h.yes:c="yes";break;case h.no:c="no"}return a.addClass("ui-button-"+c)})}}).dialog({title:h.title,width:400,minHeight:100,closeText:h.close,modal:!0,autoOpen:!1,resizable:!1,closeOnEscape:!1}),R.pool[i][c]=g,g.closest(".ui-dialog").find(".ui-dialog-titlebar-close").remove()),j=V(c,d,e,f)):(j=!0,"alert"===c?a.alert(d):a.confirm(d)?X.isFunction(e)&&e():X.isFunction(f)&&f())),j},V=function(a,c,d,e){var f,g,h,i,j,k;return k=R.i18n._SYS.dialog[X.config("lang")],j=function(a,c){return b(this).dialog("close"),X.isFunction(a)&&a(),c},g=[],f={ok:k.ok,cancel:k.cancel,yes:k.yes,no:k.no},h=R.pool.systemDialog[a],i=b("[data-role='dialog-content']",h),0===i.size()&&(i=h),"confirm"===a?(g.push({text:f.ok,click:function(){return j.apply(this,[d,!0]),!0}}),g.push({text:f.cancel,click:function(){return j.apply(this,[e,!1]),!0}})):"confirmex"===a?(g.push({text:f.yes,click:function(){return j.apply(this,[d,!0]),!0}}),g.push({text:f.no,click:function(){return j.apply(this,[e,!1]),!0}}),g.push({text:f.cancel,click:function(){return j.apply(this,[null,!1]),!0}})):(a="alert",null!==d?g.push({text:f.ok,click:function(){return j.apply(this,[d,!0]),!0}}):g=null),i.html(c||""),h.dialog("option","buttons",g).dialog("open")},v=function(){var a,b,c,d,e,f;if(a=arguments,f=a[0],e=a[1],b=R.fn.handler,0===a.length)e=w(b);else if(X.isString(f))X.isFunction(e)?b[f]=e:e=b[f];else if(X.isPlainObject(f))for(d in f)c=f[d],X.isFunction(c)&&(b[d]=c);return e},N=function(b){var c,d,e,f;if(d=null,X.isArray(b))for(e=0,f=b.length;f>e;e++)c=b[e],(X.isFunction(c)||X.isFunction(c=R.fn.handler[c]))&&c.call(a);else X.isString(b)&&(c=R.fn.handler[b],X.isFunction(c)&&(d=c.apply(a,X.slice(arguments,1))));return d},H=function(a,b){return X.isFunction(a)?R.fn[b].push(a):void 0},w=function(a){var c;return c=null,X.isArray(a)||void 0!==a.length?c=[].concat([],X.slice(a)):X.isPlainObject(a)&&(c=b.extend(!0,{},a)),c},B=function(a){return R.fn.init[a]},z=function(a,b){var c,d;return c=a.split("."),d=null,(b||!D(c[0],G.key.storage))&&(d=R,X.each(c,function(a){var b;return b=X.hasProp(a,d),d=d[a],b})),d},P=function(a,b){var c,d,e,f,g;return f=a.split("."),e=f.length,c=X.isPlainObject(b),1===e?(d=f[0],g=O(R,d,b,X.hasProp(d,R))):(g=R,X.each(f,function(a,c){return e-1>c?X.hasProp(a,g)||(g[a]={}):g[a]=O(g,a,b,X.isPlainObject(g[a])),g=g[a],!0})),g},O=function(a,c,d,e){return e&&X.isPlainObject(d)?b.extend(!0,a[c],d):a[c]=d,a[c]},C=function(a,b,c){return X.isObject(a)&&X.isString(b)&&X.hasProp(b,a)&&X.type(a[b])===c},D=function(a,c){return b.inArray(a,c)>-1},F=function(a){return G.key.storage.push(a)},R.modules.utils={handlers:[{name:"alert",handler:function(a,b){return U("alert",a,b)}},{name:"confirm",handler:function(a,b,c){return U("confirm",a,b,c)}},{name:"confirmEX",handler:function(a,b,c){return U("confirmEX",a,b,c)}},{name:"queue",handler:function(){return v.apply(a,this.slice(arguments))}},{name:"run",handler:function(){return N.apply(a,this.slice(arguments))}},{name:"url",handler:function(){var b,c;return b=a.location,c={search:b.search.substring(1),hash:b.hash.substring(1),query:{}},this.each(c.search.split("&"),function(a){return a=a.split("="),""!==X.trim(a[0])?c.query[a[0]]=a[1]:void 0}),c}},{name:"download",handler:function(b,c){var d,e,f;return a.ActiveXObject?a.ActiveXObject&&document.execCommand?(f=a.open(b,"_blank"),f.document.close(),f.document.execCommand("SaveAs",!0,c||b),f.close()):void 0:(e=document.createElement("a"),e.href=b,e.target="_blank",e.download=c||"unknown",d=document.createEvent("Event"),d.initEvent("click",!0,!0),e.dispatchEvent(d),(a.URL||a.webkitURL).revokeObjectURL(e.href))}},{name:"functionExists",handler:function(b,c){return C(c===!0?a:R.fn.handler,b,"function")}}]},J=function(a){return w(X.isPlainObject(a)?b.extend(R.config,a):R.config)},R.modules.flow={handlers:[{name:"sandbox",handler:function(a){var c;return c=J(a),N(R.fn.prepare),b(document).ready(function(){return N(R.fn.ready)}),R.sandboxStarted=!0,c||!1},value:!1,validator:function(){return R.sandboxStarted!==!0}},{name:"prepare",handler:function(a){return H(a,"prepare")}},{name:"ready",handler:function(a){return H(a,"ready")}}]},R.web_api={},R.config.api="",R.fn.init.apiNS=function(){},m=new r("I18n"),m.config({format_regexp:/\{%\s*([A-Z0-9_]+)\s*%\}/gi,value:function(a){return X.isString(a)?a:""}}),c=new r("Web_API"),c.config({format_regexp:/\:([a-z_]+)/g,value:function(a){var b;return null!=(b=u()+a)?b:""}}),L=new r("route"),L.config({format_regexp:/\:([a-z_]+)/g}),A=function(){var a,b,c;return a=arguments,b=a[0],c=a[1],X.isPlainObject(b)?X.each(b,A):X.isString(c)&&X.hasProp(c,R.fn.init)&&X.isFunction(b)?R.fn.init[c]=b:void 0},u=function(){var a;return a=X.config("api"),X.isString(a)&&""!==X.trim(a)?"/"+a:""},S=function(a,b,d){var e,f,g;switch(a){case"api":f=c,e=function(a){var b;return null!=(b=B("apiNS")(a))?b:a};break;case"route":f=L}return X.isPlainObject(b)?f.set(b):X.isString(b)&&(g=f.get(null!=e?e():b,d)),null!=g?g:null},t=function(a,b){return S("api",a,b)},t.formatList=function(a){return X.isPlainObject(a)?c.config({keys:a}):void 0},M=function(a,b){return S("route",a,b)},M.formatList=function(a){return X.isPlainObject(a)?L.config({keys:a}):void 0},R.modules.project={handlers:[{name:"config",handler:function(a){return this.isString(a)?R.config[a]:w(R.config)}},{name:"init",handler:function(){return A.apply(a,this.slice(arguments))}},{name:"i18n",handler:function(a,b){var c,d;return c=arguments,this.isPlainObject(a)?m.set(a):q.test(a)&&(2===c.length&&this.isString(b)&&!q.test(b)||(this.isPlainObject(b)?d=m.get(a,b):(d="",this.each(c,function(a){return X.isString(a)&&q.test(a)?d+=m.get(a):void 0})))),null!=d?d:null}},{name:"api",handler:t},{name:"route",handler:M}]},y=function(a){var b,c;return b={},c=a.match(/<[a-z]+[^>]*>/i),null!==c&&X.each(c[0].match(/(data(-[a-z]+)+=[^\s>]*)/gi)||[],function(a){return a=a.match(/data-(.*)="([^\s"]*)"/i),b[X.camelCase(a[1])]=a[2],!0}),b},x=function(a){var b;return b={},X.each(a,function(a){var c;return a.nodeType===d&&(c=a.nodeName.match(/^data-(.*)$/i))&&(b[X.camelCase(c(1))]=a.nodeValue),!0}),b},R.modules.storage={handlers:[{name:"data",handler:function(){var a,c,d,e,f,g;if(a=arguments,d=a.length,d>0){g=a[0];try{e=b(g).get(0)}catch(h){c=h,e=g}e&&e.nodeType===j?(f={},e.dataset?f=e.dataset:e.outerHTML?f=y(e.outerHTML):e.attributes&&b.isNumeric(e.attributes.length)&&(f=x(e.attributes))):this.isString(g)&&q.test(g)&&(f=1===d?z(g):P(g,a[1]),d>1&&E(a)===!0&&F(g.split(".")[0]))}return null!=f?f:null}},{name:"save",handler:function(){var a,c,d,e;return a=arguments,c=a[0],e=a[1],T.storage&&this.isString(c)?(d=this.access(c),localStorage.setItem(c,escape(this.isPlainObject(d)?JSON.stringify(b.extend(d,e)):e))):void 0}},{name:"access",handler:function(){var a,b,c;if(b=arguments[0],T.storage&&(c=localStorage.getItem(b),null!==c)){c=unescape(c);try{c=JSON.parse(c)}catch(d){a=d,c=c}}return c||null},value:null,validator:function(a){return this.isString(a)}},{name:"clear",handler:function(){},expose:!1}]},I=function(a,c,d,e){var f;if(0!==arguments.length)return X.isPlainObject(a)===!1&&(a={url:a}),f=B("ajaxHandler")(c,d),X.isFunction(a.success)||(a.success=f.success),X.isFunction(a.error)||(a.error=f.error),b.ajax(b.extend(a,{async:e!==!0}))},R.modules.request={handlers:[{name:"ajax",handler:function(a,b,c){return I(a,b,c)}},{name:"sjax",handler:function(a,b,c){return I(a,b,c,!0)}}]},R.modules.HTML={handlers:[{name:"encodeEntities",handler:function(a){return this.isString(a)?a.replace(/([<>&\'\"])/,function(a,b){var c;switch(b){case"<":c=lt;break;case">":c=gt;break;case'"':c=quot;break;case"'":c=apos;break;case"&":c=amp}return"&"+c+";"}):a}},{name:"decodeEntities",handler:function(){},expose:!1}]},K=function(a){return"/"===a.charAt(0)?a:"/"+a},R.modules.URL={handlers:[{name:"pathname",handler:function(a){return K(this.isString(a)?a:location.pathname)}}]},X.extend(R.modules,X),a[n.name]=X});
//# sourceMappingURL=tatami.min.map